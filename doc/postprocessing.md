In addition to the programs provided here for obtaining total protein occupancy traces from IPOD-HR data, we include here the scripts used in three key stages of postprocessing the data (as used in the accompanying [paper](https://doi.org/10.1101/2020.01.29.924811)). Each of the major drivers running these analysis stages is described below; the programs themselves are in the `postprocessing` folder of this source code distribution.

Of the programs described below, the peak caller and EPOD caller may also be used directly within the environment of our distributed singularity container (see the main documentation of this source distribution for details); the TF occupancy clustering/plotting program has additional prerequisites.

# Peak calling

The program `do_all_peak_calls_cwt.py` can be used to perform peak calling on IPOD-HR occupancy profiles as used in the paper noted above. Running the script with the `-h` argument will give usage information. The key input files are generated by the main IPOD-HR data processing pipeline, and will be located automatically through specification of the `condition_list` file that was also used for IPOD-HR data processing. Key output files will have the suffix `_cutoffXXX_cwt_peaks.gr`; the `XXX` indicates a scoring cutoff. This file contains location/value pairs at the same resolution as the input data, which will have the value 1 for positions inside of a peak, and 0 elsewhere.

## GR to GFF conversion

As an additional convenience function, we also include the program `grpeaks_to_gff.py` which permits conversion of the .gr interval definitions described above, to a more commonly used GFF file. For example, to convert a .gr file `peakcalls.gr`, one might run

`python grpeaks_to_gff.py peakcalls.gr peakcalls.gff`

See the output of the `-h` argument for additional options.

# EPOD calling

The program `calc_all_epods.py` will perform EPOD calling as described in the accompanying paper. As with the peak caller above, the condition list used by IPOD-HR itself also serves as the only needed input. Output files will include an `_epods_v3.gr` file (which is formatted as the peak `.gr` files described above), and an `_epod_locs_v3.txt` file (which simply lists the 0-indexed start and end coordinates of each EPOD, in base pairs). There are also variants of each file that contain the string `_strict`; the strict calls correspond to those used through most of the present paper (which uses as a threshold that the program must find a large region for which the average is above the 90th percentile of 256 bp window averaged data genome wide), whereas the normal calls match the definition of [Vora et al. (2009)](https://doi.org/10.1016/j.molcel.2009.06.035) where the 75th percentile is used instead. The `grpeaks_to_gff.py` may be found useful in converting the EPOD calls to another preferred format.

# TFBS occupancy plotting and clustering

The program `plot_tf_vs_cond.py` permits plotting and clustering of the occupancies of transcription factor binding sites according to their condition-level averages, facilitating comparison of the activities of different TFs across experimental conditions. Detailed instructions on the command line arguments and outputs are provided in the comments of the program itself. Note that unlike the other tools provided here, this program has additional prerequisites: functional installations of the matplotlib, sklearn, pandas, and seaborn python packages. As such, it cannot be run in our singularity container, although extensions of a similar environment should work.
